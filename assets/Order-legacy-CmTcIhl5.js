System.register(["./index-legacy-C3qDVx6g.js","./_plugin-vue_export-helper-legacy-DIrtFDCD.js","./logo-family-legacy-435wcosQ.js"],function(a,e){"use strict";var t,i,c,n,s,d,l,o,r,u,v,p,f,m,h,g,x,b,y,w,k,z,C;return{setters:[a=>{t=a.an,i=a.b,c=a.ap,n=a.ao,s=a.aC,d=a.w,l=a.aq,o=a.d,r=a.ar,u=a.as,v=a.au,p=a.av,f=a.at,m=a.aw,h=a.ax,g=a.az,x=a.aA,b=a.aB,y=a.aD},a=>{w=a.u,k=a.a,z=a._},a=>{C=a.l}],execute:function(){var _=document.createElement("style");_.textContent=".order[data-v-c67241cc]{min-height:calc(var(--vh, 1vh) * 100);background:#f5f5f5}.family-header[data-v-c67241cc]{display:flex;align-items:center;gap:12px;padding:16px;background:#fff;border-bottom:1px solid #f0f0f0}.family-info[data-v-c67241cc]{flex:1}.family-name[data-v-c67241cc]{font-size:16px;font-weight:600;color:#333}.family-date[data-v-c67241cc]{font-size:14px;color:#999;margin-top:4px}.meal-tabs[data-v-c67241cc]{position:sticky;top:0;z-index:10}.main-content[data-v-c67241cc]{padding:16px 16px 100px}.menu-container[data-v-c67241cc]{display:flex;background:#fff;border-radius:16px;overflow:hidden;box-shadow:0 2px 12px rgba(0,0,0,.05)}.category-sidebar[data-v-c67241cc]{width:100px;flex-shrink:0;border-right:1px solid #f0f0f0}[data-v-c67241cc] .van-sidebar-item{text-align:center;padding:20px 12px}[data-v-c67241cc] .van-sidebar-item--select{background:#e6f2ff;border-right:3px solid #1989fa}.dish-list-container[data-v-c67241cc]{flex:1;padding:16px}.dish-grid[data-v-c67241cc]{display:grid;grid-template-columns:repeat(2,1fr);gap:16px}.dish-card[data-v-c67241cc]{background:#fff;border-radius:12px;overflow:hidden;box-shadow:0 2px 8px rgba(0,0,0,.05);transition:all .2s}.dish-card[data-v-c67241cc]:hover{transform:translateY(-2px);box-shadow:0 4px 12px rgba(0,0,0,.1)}.dish-image-container[data-v-c67241cc]{position:relative}.image-placeholder[data-v-c67241cc]{display:flex;align-items:center;justify-content:center;width:100%;height:120px;background:#f8f9fa}.dish-info[data-v-c67241cc]{padding:12px}.dish-name[data-v-c67241cc]{font-size:15px;font-weight:600;color:#333;margin-bottom:4px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.dish-category[data-v-c67241cc]{font-size:12px;color:#999;margin-bottom:12px}.dish-actions[data-v-c67241cc]{display:flex;justify-content:center}.order-summary[data-v-c67241cc]{background:#fff;border-radius:16px;padding:16px;margin-top:16px;box-shadow:0 2px 12px rgba(0,0,0,.05)}.summary-item[data-v-c67241cc]{display:flex;justify-content:space-between;align-items:center;padding:8px 0;font-size:14px}.summary-item[data-v-c67241cc]:first-child{border-bottom:1px solid #f0f0f0}.summary-item span[data-v-c67241cc]:last-child{font-weight:600;color:#1989fa}.submit-tip[data-v-c67241cc]{display:flex;align-items:center;gap:4px;font-size:12px;color:#999}@media(max-width:360px){.dish-grid[data-v-c67241cc]{grid-template-columns:1fr}.category-sidebar[data-v-c67241cc]{width:80px}[data-v-c67241cc] .van-sidebar-item{padding:16px 8px;font-size:13px}}@media(min-width:768px){.dish-grid[data-v-c67241cc]{grid-template-columns:repeat(3,1fr)}.main-content[data-v-c67241cc]{max-width:1200px;margin:0 auto}.menu-container[data-v-c67241cc]{height:calc(100vh - 280px)}.dish-list-container[data-v-c67241cc]{height:100%;overflow-y:auto}}\n/*$vite$:1*/",document.head.appendChild(_);const j={class:"order"},L={class:"family-header"},S={class:"family-info"},T={class:"family-name"},V={class:"family-date"},D={class:"main-content"},U={class:"menu-container"},$={class:"dish-list-container"},A={class:"dish-grid"},M={class:"dish-image-container"},q={class:"image-placeholder"},B={class:"image-placeholder"},I={class:"dish-info"},O={class:"dish-name"},Z={class:"dish-category"},E={class:"dish-actions"},F={class:"order-summary"},G={class:"summary-item"},Y={class:"summary-item"},H={class:"submit-tip"};a("default",z(t({__name:"Order",setup(a){const t=p(),z=s(),_=w(),N=k(),J=i(C),K=i("温馨小家"),P=i("lunch"),Q=c(()=>({breakfast:"早餐",lunch:"午餐",dinner:"晚餐"}[P.value])),R=i(!1),W=c(()=>_.next7Days()),X=i(W.value[0]?.value||`${(aa=new Date).getFullYear()}-${String(aa.getMonth()+1).padStart(2,"0")}-${String(aa.getDate()).padStart(2,"0")}`);var aa;const ea=c(()=>W.value.find(a=>a.value===X.value)?.label||"今天");function ta(){R.value=!0}const ia=c(()=>W.value.map(a=>({name:a.label,value:a.value})));function ca(a){X.value=a.value,R.value=!1,ra()}const na=i(0),sa=c(()=>_.categories);function da(a){const e=N.getCounts(X.value,P.value),t=_.dishes.filter(e=>e.categoryId===a).reduce((a,t)=>a+(e[t.id]||0),0);return t>0?t:void 0}const la=c(()=>{const a=sa.value[na.value];return _.dishes.filter(e=>e.categoryId===a?.id)}),oa=i({});function ra(){oa.value=N.getCounts(X.value,P.value)}const ua=c(()=>Object.values(oa.value).filter(a=>a>0).length),va=c(()=>Object.values(oa.value).reduce((a,e)=>a+(e||0),0));async function pa(){try{y(async()=>{const{showToast:a}=await e.import("./index-legacy-RiViYB6S.js");return{showToast:a}},void 0).then(({showToast:a})=>a({message:"点餐提交成功！",type:"success",duration:1500})),setTimeout(()=>{t.push("/")},1500)}catch(a){y(async()=>{const{showToast:a}=await e.import("./index-legacy-RiViYB6S.js");return{showToast:a}},void 0).then(({showToast:a})=>a({message:"提交失败，请重试",type:"fail"}))}}return n(()=>{const a=z.query.date||X.value;X.value=a;const e=z.query.meal;P.value=e||function(){const a=(new Date).getHours();return a<10?"breakfast":a<16?"lunch":"dinner"}(),ra()}),d(P,()=>{ra()}),d(X,()=>{ra()}),(a,e)=>{const i=f("van-icon"),c=f("van-nav-bar"),n=f("van-image"),s=f("van-tab"),d=f("van-tabs"),p=f("van-sidebar-item"),y=f("van-sidebar"),w=f("van-stepper"),k=f("van-list"),z=f("van-submit-bar"),C=f("van-action-sheet");return h(),l("div",j,[o(c,{title:"点餐","left-arrow":"",fixed:"",placeholder:"",onClickLeft:e[0]||(e[0]=a=>v(t).go(-1))},{right:u(()=>[o(i,{name:"calendar-o",size:"20",onClick:ta})]),_:1}),r("div",L,[o(n,{src:J.value,width:"40",height:"40",round:""},null,8,["src"]),r("div",S,[r("div",T,m(K.value),1),r("div",V,m(ea.value)+" · "+m(Q.value),1)])]),o(d,{active:P.value,"onUpdate:active":e[1]||(e[1]=a=>P.value=a),class:"meal-tabs",type:"card",color:"#1989fa",background:"#f5f5f5",animated:""},{default:u(()=>[o(s,{title:"早餐",name:"breakfast"}),o(s,{title:"午餐",name:"lunch"}),o(s,{title:"晚餐",name:"dinner"})]),_:1},8,["active"]),r("div",D,[r("div",U,[o(y,{modelValue:na.value,"onUpdate:modelValue":e[2]||(e[2]=a=>na.value=a),class:"category-sidebar"},{default:u(()=>[(h(!0),l(g,null,x(sa.value,a=>(h(),b(p,{key:a.id,title:a.name,badge:da(a.id)},null,8,["title","badge"]))),128))]),_:1},8,["modelValue"]),r("div",$,[o(k,{"finished-text":"没有更多了"},{default:u(()=>[r("div",A,[(h(!0),l(g,null,x(la.value,a=>(h(),l("div",{key:a.id,class:"dish-card"},[r("div",M,[o(n,{src:a.imageUrl||v("data:image/svg+xml,%3csvg%20width='128'%20height='96'%20viewBox='0%200%20128%2096'%20xmlns='http://www.w3.org/2000/svg'%3e%3cdefs%3e%3clinearGradient%20id='bg'%20x1='0'%20x2='1'%20y1='0'%20y2='1'%3e%3cstop%20offset='0%25'%20stop-color='%237AD3E7'/%3e%3cstop%20offset='100%25'%20stop-color='%23A78BFA'/%3e%3c/linearGradient%3e%3c/defs%3e%3crect%20x='0'%20y='0'%20width='128'%20height='96'%20rx='12'%20fill='url(%23bg)'/%3e%3cg%20fill='%23fff'%20stroke='%23fff'%20stroke-width='1.5'%20opacity='0.95'%3e%3cpath%20d='M24%2062%20C24%2074%20104%2074%20104%2062%20C88%2062%2072%2054%2064%2046%20C56%2054%2040%2062%2024%2062%20Z'/%3e%3cpath%20d='M40%2030%20L42%2028%20L80%2056%20L78%2058%20Z'/%3e%3cpath%20d='M48%2024%20L50%2022%20L88%2050%20L86%2052%20Z'/%3e%3c/g%3e%3c/svg%3e"),width:"100%",height:"120",fit:"cover",radius:"12"},{loading:u(()=>[r("div",q,[o(i,{name:"photo",size:"24",color:"#ccc"})])]),error:u(()=>[r("div",B,[o(i,{name:"photo-fail",size:"24",color:"#ccc"})])]),_:1},8,["src"])]),r("div",I,[r("div",O,m(a.name),1),r("div",Z,m(a.categoryName),1),r("div",E,[o(w,{modelValue:oa.value[a.id],"onUpdate:modelValue":e=>oa.value[a.id]=e,integer:"",min:"0",max:"99",theme:"round","button-size":"24",onChange:e=>{return t=a.id,i=oa.value[a.id]??0,void N.setCount(X.value,P.value,t,i||0);var t,i}},null,8,["modelValue","onUpdate:modelValue","onChange"])])])]))),128))])]),_:1})])]),r("div",F,[r("div",G,[e[4]||(e[4]=r("span",null,"已选菜品",-1)),r("span",null,m(ua.value)+" 道",1)]),r("div",Y,[e[5]||(e[5]=r("span",null,"总计份数",-1)),r("span",null,m(va.value)+" 份",1)])])]),o(z,{price:100*va.value,"button-text":"提交点餐",onSubmit:pa,"safe-area-inset-bottom":""},{tip:u(()=>[r("div",H,[o(i,{name:"info-o"}),e[6]||(e[6]=r("span",null,"提交后可在食谱页面查看",-1))])]),_:1},8,["price"]),o(C,{show:R.value,"onUpdate:show":e[3]||(e[3]=a=>R.value=a),actions:ia.value,"cancel-text":"取消",onSelect:ca,"close-on-click-action":""},null,8,["show","actions"])])}}}),[["__scopeId","data-v-c67241cc"]]))}}});

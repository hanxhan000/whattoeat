System.register(["./index-legacy-CNR_Qhze.js","./order-legacy-Cv0HZm4J.js","./_plugin-vue_export-helper-legacy-BVIICed7.js"],function(e,a){"use strict";var t,n,l,i,u,s,o,c,r,d,v,m,p,h,f,g,y,x,b,_,k;return{setters:[e=>{t=e.aJ,n=e.aq,l=e.ap,i=e.as,u=e.b,s=e.at,o=e.d,c=e.au,r=e.av,d=e.ax,v=e.ay,m=e.aw,p=e.az,h=e.aI,f=e.aA,g=e.aB,y=e.aC,x=e.aD,b=e.aE},e=>{_=e.u},e=>{k=e._}],execute:function(){var a=document.createElement("style");function q(e){return"string"==typeof e?{name:e,quantity:1}:{name:e.name,quantity:e.quantity??1,unit:e.unit}}a.textContent=".cart[data-v-a46a0306]{min-height:calc(var(--vh, 1vh) * 100);background:var(--bg-color)}.header[data-v-a46a0306]{display:flex;justify-content:space-between;align-items:center;padding:12px 16px;background:#fff;border-bottom:1px solid #f0f0f0}.date[data-v-a46a0306]{font-weight:600;color:#a06600}.main-content[data-v-a46a0306]{padding:16px}.empty[data-v-a46a0306]{margin-top:32px}[data-v-a46a0306] .van-cell__title{display:flex;align-items:center;gap:8px}\n/*$vite$:1*/",document.head.appendChild(a);const C=t("cart",{state:()=>({purchased:{}}),actions:{togglePurchased(e,a){this.purchased[e]||(this.purchased[e]={}),this.purchased[e][a]=!this.purchased[e][a]},clearPurchased(e){this.purchased[e]={}},aggregate(e){const a=_(),t=n(),l=["breakfast","lunch","dinner"],i=new Map;for(const n of l){const l=a.getCounts(e,n);for(const[e,a]of Object.entries(l)){if(a<=0)continue;const n=t.dishes.find(a=>a.id===e);n&&n.ingredients&&0!==n.ingredients.length&&n.ingredients.forEach(e=>{const{name:t,quantity:l,unit:u}=q(e),s=l*a,o=i.get(t);o?(o.quantity+=s,o.unit!==u&&(o.unit=void 0),o.fromDishes.includes(n.name)||o.fromDishes.push(n.name)):i.set(t,{name:t,quantity:s,unit:u,fromDishes:[n.name]})})}}return Array.from(i.values()).sort((e,a)=>e.name.localeCompare(a.name))}}}),w={class:"cart"},j={class:"header"},D={class:"date"},$={class:"main-content"},P={key:0,class:"empty"};e("default",k(l({__name:"Cart",setup(e){const a=v(),t=n(),l=C(),_=i(()=>t.next7Days()),k=u(_.value[0]?.value||""),q=i(()=>_.value.find(e=>e.value===k.value)?.label||"今天"),z=i(()=>l.aggregate(k.value));function E(e){return e.unit?`${e.quantity}${e.unit}`:`${e.quantity}份`}function U(){l.clearPurchased(k.value)}const A=u(!1),I=i(()=>_.value.map(e=>({name:e.label,value:e.value})));function S(){A.value=!0}function V(e){k.value=e.value}return(e,t)=>{const n=m("van-icon"),i=m("van-nav-bar"),u=m("van-button"),v=m("van-checkbox"),_=m("van-cell"),C=m("van-cell-group"),B=m("van-empty"),J=m("van-action-sheet");return f(),s("div",w,[o(i,{title:"购物清单","left-arrow":"",fixed:"",placeholder:"",onClickLeft:t[0]||(t[0]=e=>d(a).go(-1))},{right:r(()=>[o(n,{name:"calendar-o",size:"20",onClick:S})]),_:1}),c("div",j,[c("div",D,p(q.value),1),o(u,{type:"primary",size:"small",round:"",onClick:U},{default:r(()=>[...t[2]||(t[2]=[g("清除已购标记",-1)])]),_:1})]),c("div",$,[o(C,{inset:""},{default:r(()=>[(f(!0),s(y,null,x(z.value,e=>(f(),b(_,{key:e.name,title:e.name,value:E(e),label:e.fromDishes.join("，")},{icon:r(()=>{return[o(v,{"model-value":(a=e.name,!!l.purchased[k.value]?.[a]),"onUpdate:modelValue":()=>function(e){l.togglePurchased(k.value,e)}(e.name)},null,8,["model-value","onUpdate:modelValue"])];var a}),_:2},1032,["title","value","label"]))),128))]),_:1}),0===z.value.length?(f(),s("div",P,[o(B,{description:"今天暂无点餐，去点餐吧"})])):h("",!0)]),o(J,{show:A.value,"onUpdate:show":t[1]||(t[1]=e=>A.value=e),actions:I.value,"cancel-text":"取消",onSelect:V,"close-on-click-action":""},null,8,["show","actions"])])}}}),[["__scopeId","data-v-a46a0306"]]))}}});

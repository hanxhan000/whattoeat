System.register(["./index-legacy-BZW8kIiO.js","./order-legacy-C7fYEhEl.js","./_plugin-vue_export-helper-legacy-BVIICed7.js"],function(e,a){"use strict";var t,n,l,i,c,u,s,o,r,d,v,f,m,p,h,g,y,b,x,_,k;return{setters:[e=>{t=e.aJ,n=e.aq,l=e.ap,i=e.as,c=e.b,u=e.at,s=e.d,o=e.au,r=e.av,d=e.ax,v=e.ay,f=e.aw,m=e.az,p=e.aI,h=e.aA,g=e.aB,y=e.aC,b=e.aD,x=e.aE},e=>{_=e.u},e=>{k=e._}],execute:function(){var a=document.createElement("style");function q(e){return"string"==typeof e?{name:e,quantity:1}:{name:e.name,quantity:e.quantity??1,unit:e.unit}}a.textContent=".cart[data-v-ebc6f843]{min-height:calc(var(--vh, 1vh) * 100);background:var(--bg-color)}.header[data-v-ebc6f843]{display:flex;justify-content:space-between;align-items:center;padding:12px 16px;background:#fff;border-bottom:1px solid #f0f0f0}.date[data-v-ebc6f843]{font-weight:600;color:#a06600}.main-content[data-v-ebc6f843]{padding:16px}.empty[data-v-ebc6f843]{margin-top:32px}[data-v-ebc6f843] .van-cell__title{display:flex;align-items:center;gap:8px}\n/*$vite$:1*/",document.head.appendChild(a);const C=t("cart",{state:()=>({purchased:{}}),actions:{togglePurchased(e,a){this.purchased[e]||(this.purchased[e]={}),this.purchased[e][a]=!this.purchased[e][a]},clearPurchased(e){this.purchased[e]={}},aggregate(e){const a=_(),t=n(),l=["breakfast","lunch","dinner"],i=new Map;for(const n of l){const l=a.getCounts(e,n);for(const[e,a]of Object.entries(l)){if(a<=0)continue;const n=t.dishes.find(a=>a.id===e);n&&n.ingredients&&0!==n.ingredients.length&&n.ingredients.forEach(e=>{const{name:t,quantity:l,unit:c}=q(e),u=l*a,s=i.get(t);s?(s.quantity+=u,s.unit!==c&&(s.unit=void 0),s.fromDishes.includes(n.name)||s.fromDishes.push(n.name)):i.set(t,{name:t,quantity:u,unit:c,fromDishes:[n.name]})})}}return Array.from(i.values()).sort((e,a)=>e.name.localeCompare(a.name))}}}),w={class:"cart"},j={class:"header"},D={class:"date"},$={class:"main-content"},P={key:0,class:"empty"};e("default",k(l({__name:"Cart",setup(e){const a=v(),t=n(),l=C(),_=i(()=>t.next7Days()),k=c(_.value[0]?.value||""),q=i(()=>_.value.find(e=>e.value===k.value)?.label||"今天"),z=i(()=>l.aggregate(k.value));function E(e){return e.unit?`${e.quantity}${e.unit}`:`${e.quantity}份`}function U(){l.clearPurchased(k.value)}const A=c(!1),I=i(()=>_.value.map(e=>({name:e.label,value:e.value})));function S(){A.value=!0}function V(e){k.value=e.value}return(e,t)=>{const n=f("van-icon"),i=f("van-nav-bar"),c=f("van-button"),v=f("van-checkbox"),_=f("van-cell"),C=f("van-cell-group"),B=f("van-empty"),J=f("van-action-sheet");return h(),u("div",w,[s(i,{title:"购物清单","left-arrow":"",fixed:"",placeholder:"",onClickLeft:t[0]||(t[0]=e=>d(a).go(-1))},{right:r(()=>[s(n,{name:"calendar-o",size:"20",onClick:S})]),_:1}),o("div",j,[o("div",D,m(q.value),1),s(c,{type:"primary",size:"small",round:"",onClick:U},{default:r(()=>[...t[2]||(t[2]=[g("清除已购标记",-1)])]),_:1})]),o("div",$,[s(C,{inset:""},{default:r(()=>[(h(!0),u(y,null,b(z.value,e=>(h(),x(_,{key:e.name,title:e.name,value:E(e),label:e.fromDishes.join("，")},{icon:r(()=>{return[s(v,{"model-value":(a=e.name,!!l.purchased[k.value]?.[a]),"onUpdate:modelValue":()=>function(e){l.togglePurchased(k.value,e)}(e.name)},null,8,["model-value","onUpdate:modelValue"])];var a}),_:2},1032,["title","value","label"]))),128))]),_:1}),0===z.value.length?(h(),u("div",P,[s(B,{description:"今天暂无点餐，去点餐吧"})])):p("",!0)]),s(J,{show:A.value,"onUpdate:show":t[1]||(t[1]=e=>A.value=e),actions:I.value,"cancel-text":"取消",onSelect:V,"close-on-click-action":""},null,8,["show","actions"])])}}}),[["__scopeId","data-v-ebc6f843"]]))}}});

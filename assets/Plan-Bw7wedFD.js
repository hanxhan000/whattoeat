import{ap as L,aq as O,as as x,aw as m,at as l,aA as s,aH as V,au as t,az as r,d as c,aI as I,aC as k,aD as w,av as z,aB as q,b as S,ax as E,ay as F,aE as P}from"./index-Du8x3b-s.js";import{u as T}from"./order-FQPdvisU.js";import{_ as N}from"./_plugin-vue_export-helper-DlAUqK2U.js";const j={class:"card-header"},A={class:"header-left"},H={class:"meal-title"},R={class:"deadline-tag"},U={class:"header-right"},Y={key:0,class:"selection-count"},G={class:"card-content"},J={key:0,class:"empty-state"},K={key:1,class:"selection-list"},Q={class:"dish-name"},W={class:"card-footer"},X=L({__name:"MealCard",props:{date:{},meal:{}},emits:["select-dish"],setup(B,{emit:p}){const _=B,y=p,f=T(),b=O(),h=x(()=>({breakfast:"早餐",lunch:"午餐",dinner:"晚餐"})[_.meal]),g=x(()=>({breakfast:"07:00",lunch:"11:00",dinner:"17:00"})[_.meal]),u=x(()=>{const v=f.getCounts(_.date,_.meal);return Object.entries(v).filter(([a,e])=>e>0).map(([a,e])=>{const i=b.dishes.find(n=>n.id===a);return i?"".concat(i.name,"×").concat(e):"未知菜品(".concat(a,")×").concat(e)})});function C(){y("select-dish",_.date,_.meal)}return(v,a)=>{const e=m("van-icon"),i=m("van-button");return s(),l("div",{class:V(["meal-card",{"has-selection":u.value.length>0}])},[t("div",j,[t("div",A,[t("h3",H,r(h.value),1),t("div",R,[c(e,{name:"clock-o",size:"14"}),t("span",null,"截止："+r(g.value),1)])]),t("div",U,[u.value.length>0?(s(),l("div",Y," 已选 "+r(u.value.length)+" 道 ",1)):I("",!0)])]),t("div",G,[u.value.length===0?(s(),l("div",J,[c(e,{name:"food-o",size:"32"}),a[0]||(a[0]=t("p",{class:"empty-text"},"还没有选择菜品",-1))])):(s(),l("div",K,[(s(!0),l(k,null,w(u.value,(n,d)=>(s(),l("div",{key:d,class:"selected-item"},[c(e,{name:"checked",color:"#1989fa"}),t("span",Q,r(n),1)]))),128))]))]),t("div",W,[c(i,{type:"primary",size:"small",block:"",round:"",onClick:C},{default:z(()=>[q(r(u.value.length>0?"修改菜品":"选择菜品"),1)]),_:1})])],2)}}}),M=N(X,[["__scopeId","data-v-1b5d1e2b"]]),Z={class:"plan"},ee={class:"main-content"},te={class:"date-navigation"},ae={class:"day-content"},se={class:"day-header"},ne={class:"day-title"},oe={class:"meals-container"},le={key:0,class:"overview-section"},ce={class:"section-header"},ie={class:"overview-content"},de={class:"overview-day-header"},re={class:"day-label"},_e={class:"overview-meals"},ue={class:"meal-label"},ve={class:"meal-content"},me=L({__name:"Plan",setup(B){const p=F();function _(a){const e=a.getFullYear(),i="".concat(a.getMonth()+1).padStart(2,"0"),n="".concat(a.getDate()).padStart(2,"0");return"".concat(e,"-").concat(i,"-").concat(n)}function y(a=7){const e=[],i=new Date;for(let n=0;n<a;n++){const d=new Date(i.getTime()+n*864e5),D=["日","一","二","三","四","五","六"][d.getDay()];e.push({date:_(d),label:"".concat(d.getMonth()+1,"/").concat(d.getDate()),fullLabel:"".concat(d.getMonth()+1,"月").concat(d.getDate(),"日 (星期").concat(D,")")})}return e}const f=S(y()),b=S(0),h=S(!1);function g(){h.value=!h.value}function u(a){return{breakfast:"早餐",lunch:"午餐",dinner:"晚餐"}[a]||a}function C(a,e){return""}function v(a,e){p.push({path:"/order",query:{date:a,meal:e}})}return(a,e)=>{const i=m("van-nav-bar"),n=m("van-icon"),d=m("van-tab"),D=m("van-tabs");return s(),l("div",Z,[c(i,{title:"未来7天食谱","left-arrow":"",fixed:"",placeholder:"",onClickLeft:e[0]||(e[0]=o=>E(p).go(-1))}),t("div",ee,[t("div",te,[c(D,{active:b.value,"onUpdate:active":e[1]||(e[1]=o=>b.value=o),class:"date-tabs",color:"#1989fa",background:"#f5f5f5",animated:"",swipeable:""},{default:z(()=>[(s(!0),l(k,null,w(f.value,(o,$)=>(s(),P(d,{key:o.date,title:o.label,name:$},{default:z(()=>[t("div",ae,[t("div",se,[c(n,{name:"underway-o"}),t("span",ne,r(o.fullLabel),1)]),t("div",oe,[c(M,{date:o.date,meal:"breakfast",onSelectDish:v},null,8,["date"]),c(M,{date:o.date,meal:"lunch",onSelectDish:v},null,8,["date"]),c(M,{date:o.date,meal:"dinner",onSelectDish:v},null,8,["date"])])])]),_:2},1032,["title","name"]))),128))]),_:1},8,["active"])]),h.value?(s(),l("div",le,[t("div",ce,[e[2]||(e[2]=t("h3",{class:"section-title"},"食谱概览",-1)),c(n,{name:"arrow-down",onClick:g})]),t("div",ie,[(s(!0),l(k,null,w(f.value,o=>(s(),l("div",{key:o.date,class:"overview-day"},[t("div",de,[t("span",re,r(o.label),1)]),t("div",_e,[(s(),l(k,null,w(["breakfast","lunch","dinner"],$=>t("div",{key:$,class:"overview-meal"},[t("span",ue,r(u($)),1),t("span",ve,r(C(o.date)||"未选择"),1)])),64))])]))),128))])])):(s(),l("div",{key:1,class:"collapsed-overview",onClick:g},[c(n,{name:"arrow-up"}),e[3]||(e[3]=t("span",null,"展开食谱概览",-1))]))])])}}}),be=N(me,[["__scopeId","data-v-6aa43ab5"]]);export{be as default};

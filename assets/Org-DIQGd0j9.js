import{aJ as j,aK as E,aL as L,aM as D,aN as I,ap as J,as as C,b as p,ar as M,at as d,d as a,au as o,ax as w,ay as z,aw as i,aI as x,az as h,aC as A,aD as F,av as _,aA as c,aB as O}from"./index-BnxfYfV4.js";import{l as K}from"./logo-family-warm-2oHN8ny6.js";import{_ as R}from"./_plugin-vue_export-helper-DlAUqK2U.js";const T=j("org",{state:()=>({orgs:[],current:null,loading:!1,error:""}),actions:{async init(){this.loading=!0,this.error="";try{this.orgs=await D(),this.current=await I()}catch(r){this.error=r instanceof Error?r.message:String(r)}finally{this.loading=!1}},async create(r,u,t){this.loading=!0,this.error="";try{const n=await L(r,u,t);return this.orgs.push(n),this.current=n,n}catch(n){return this.error=n instanceof Error?n.message:String(n),null}finally{this.loading=!1}},async join(r,u){this.loading=!0,this.error="";try{const t=await E(r,u);return t&&(this.current=t,await this.init()),t}catch(t){return this.error=t instanceof Error?t.message:String(t),null}finally{this.loading=!1}}}}),$={class:"org"},q={class:"main-content"},G={key:0,class:"current"},H={class:"info"},P={class:"name"},Q={class:"code"},W={key:0,class:"members"},X={class:"members-list"},Y={class:"form"},Z={class:"form"},ee=J({__name:"Org",setup(r){const u=z(),t=T(),n=C(()=>t.loading),l=C(()=>t.current),m=p(""),v=p(""),g=p("");M(()=>{t.init()});async function N(){m.value.trim()&&await t.create(m.value.trim())}async function S(){!v.value.trim()||!g.value.trim()||await t.join(v.value.trim(),g.value.trim())}return(te,e)=>{var k;const B=i("van-nav-bar"),U=i("van-image"),y=i("van-cell"),f=i("van-field"),b=i("van-button"),V=i("van-cell-group");return c(),d("div",$,[a(B,{title:"家庭/组织","left-arrow":"",fixed:"",placeholder:"",onClickLeft:e[0]||(e[0]=s=>w(u).go(-1))}),o("div",q,[l.value?(c(),d("div",G,[e[5]||(e[5]=o("div",{class:"cover"},null,-1)),o("div",H,[a(U,{src:l.value.logoUrl||w(K),width:"48",height:"48",round:""},null,8,["src"]),o("div",null,[o("div",P,h(l.value.name),1),o("div",Q,"加入码："+h(l.value.code),1)])]),(k=l.value.members)!=null&&k.length?(c(),d("div",W,[e[4]||(e[4]=o("div",{class:"members-title"},"成员",-1)),o("div",X,[(c(!0),d(A,null,F(l.value.members,s=>(c(),d("div",{key:s.id,class:"member"},h(s.nickname),1))),128))])])):x("",!0)])):x("",!0),a(V,{inset:""},{default:_(()=>[a(y,{title:"创建家庭/组织",label:"输入名称，生成加入码"}),o("div",Y,[a(f,{modelValue:m.value,"onUpdate:modelValue":e[1]||(e[1]=s=>m.value=s),placeholder:"例如：温馨小家"},null,8,["modelValue"]),a(b,{type:"primary",round:"",block:"",onClick:N,loading:n.value},{default:_(()=>[...e[6]||(e[6]=[O("创建",-1)])]),_:1},8,["loading"])])]),_:1}),a(V,{inset:""},{default:_(()=>[a(y,{title:"加入组织",label:"输入加入码与昵称"}),o("div",Z,[a(f,{modelValue:v.value,"onUpdate:modelValue":e[2]||(e[2]=s=>v.value=s),placeholder:"加入码"},null,8,["modelValue"]),a(f,{modelValue:g.value,"onUpdate:modelValue":e[3]||(e[3]=s=>g.value=s),placeholder:"昵称"},null,8,["modelValue"]),a(b,{type:"success",round:"",block:"",onClick:S,loading:n.value},{default:_(()=>[...e[7]||(e[7]=[O("加入",-1)])]),_:1},8,["loading"])])]),_:1}),e[8]||(e[8]=o("div",{class:"tip"},"说明：当前为本地模拟云端，方便先行体验与共享。",-1))])])}}}),se=R(ee,[["__scopeId","data-v-728ab7d2"]]);export{se as default};
